\documentclass[10pt]{article}

\usepackage[T1]{fontenc}
\usepackage[hidelinks]{hyperref}
\usepackage[explicit]{titlesec}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amsthm,amssymb,amsfonts,mathrsfs,mathtools,nicematrix,chngcntr,centernot,ytableau,tikz-cd}
\usepackage{textcomp,tocloft,environ,setspace,geometry,enumerate,enumitem,blindtext,multicol,xcolor,fancyhdr,calligra,graphicx,wrapfig,pgfplots,mdframed,tabularx,lipsum,comment,csquotes,imakeidx,etoolbox}

% Title page setup
\newcommand{\hsetup}{%
    \begin{center}
        \Huge\bfseries\htitle \\
        \vspace{2pt}
        \Large{\hauthor}
    \end{center} 
    \normalsize
    \vspace{-20.5pt}
    \phantom{}\hrule\phantom{}
}

% Table of Contents
\renewcommand*\contentsname{}
\newcommand{\htoc}{%
    \normalsize
    \pagenumbering{gobble}
    \begin{frame}{}
        \begin{multicols}{2}
          \tableofcontents
        \end{multicols}
    \end{frame}
    \thispagestyle{empty}
    \vspace{-6.5pt}\phantom{}\hrule\phantom{}
}

% Mainmatter setup
\newcommand{\hmain}{%
    \pagestyle{fancy}
    \fancyhead[L]{\hauthor}      
    \fancyhead[R]{\thepage}    
    \fancyhead[C]{\htitle}             
    \renewcommand{\headrulewidth}{0.5pt}
    \fancyfoot{}
}

% Adjust the headheight
\setlength{\headheight}{13pt}

\def\htitle{Test Document}
\def\hauthor{Hello World}

\makeindex

\begin{document}

\hsetup\
\htoc\
\hmain\


\section{This is a test}
index\index{index}

\section{This is a test}

\printindex

\end{document}